<!--
 *   Licensed to the Apache Software Foundation (ASF) under one
 *   or more contributor license agreements.  See the NOTICE file
 *   distributed with this work for additional information
 *   regarding copyright ownership.  The ASF licenses this file
 *   to you under the Apache License, Version 2.0 (the
 *   "License"); you may not use this file except in compliance
 *   with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 *   Unless required by applicable law or agreed to in writing,
 *   software distributed under the License is distributed on an
 *   "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 *   KIND, either express or implied.  See the License for the
 *   specific language governing permissions and limitations
 *   under the License.
 *
-->
<html>
<head>
    <title>Apache Fortress Ten Minute Guide</title>
    <link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
</head>
<body>
<hr>
<fieldset>
    <legend><b>Navigation Links</b></legend>
    <ul>
        <li><a href="./apache-directory-server.html">Setup Apache Directory Server</a></li>
        <li><a href="./apache-directory-studio.html">Setup Apache Directory Studio</a></li>
        <li><a href="./apache-fortress-core.html">Build Apache Fortress Core</a></li>
        <li><a href="./apache-fortress-realm.html">Build Apache Fortress Realm</a></li>
        <li><a href="./apache-tomcat.html">Setup Apache Tomcat Web Server</a></li>
        <li><a href="./apache-fortress-web.html">Build Apache Fortress Web</a></li>
        <li><a href="./apache-fortress-rest.html">Build Apache Fortress Rest</a></li>
    </ul>
    <li><a href="./ten-minute-guide.html">Ten Minute Guide</a></li>
</fieldset>
<hr>
<p>

<h3>Build Apache Fortress Core</h3>
<img src="fortress100.gif">
<br><br>This section provides instructions to install Fortress and run the junit tests.
<h4>Steps to build the Fortress Core</h4>
<ol>
    <li>
        Clone the <a href="https://git-wip-us.apache.org/repos/asf?p=directory-fortress-core.git">Directory Fortress
        Core Git repo</a>:
            <pre>
                <p style="font: monospace; color: black; background-color: lightgrey; font-size: 10pt">
git clone https://git-wip-us.apache.org/repos/asf/directory-fortress-core.git
                </p>
            </pre>

    </li>

    <li>Set java and maven home env variables.</li>

    <br>

    <li>
        Change directory:
            <pre>
                <p style="font: monospace; color: black; background-color: lightgrey; font-size: 10pt">
cd directory-fortress-core/
                </p>
            </pre>
    </li>

    <li>
        Copy build.properties.example in root folder of package, to build.properties.
              <pre>
                <p style="font: monospace; color: black; background-color: lightgrey; font-size: 10pt">
cp build.properties.example build.properties
                </p>
              </pre>
    </li>

    <li>
        Edit the build.properties in root folder of package.
        These parameters are bound for files like <b>config/fortress.properties</b> and <b>ldap/setup/refreshLDAPData.xml</b>
        and used on subsequent steps.
        <br>
        Change the settings to:

              <pre>
                <p style="font: monospace; color: black; background-color: lightgrey; font-size: 10pt">
# This points fortress to LDAP host.
ldap.host=localhost
ldap.port=10389
ldap.server.type=apacheds
                </p>
              </pre>

    </li>

    <li>
        Build fortress core with maven and install to local repo. The fortress realm [<a
            href="apache-fortress-realm.html">Install Apache Fortress Realm</a>]
        is dependent on fortress core.
                <pre>
                    <p style="font: monospace; color: black; background-color: lightgrey; font-size: 10pt">
mvn clean install -DskipTests
                    </p>
                </pre>
    </li>

    <li>
        Verify the following files were created by build as they are required later:
                <pre>
                    <p style="font: monospace; color: black; background-color: lightgrey; font-size: 10pt">
ls -l config/fortress.properties
ls -l ldap/setup/refreshLDAPData.xml
                    </p>
                </pre>
    </li>

    <li>
        Load the fortress schema contained in <b>ldap/schema/apacheds-fortress.ldif</b> to ApacheDS instance using
        Apache Directory Studio.

        <br><br>

        <ol type="A">
            <li>
                In Apache Directory Studio LDAP Browser perspective, select Root DSE, right-click, and choose
                Import->LDIF Import
            </li>
            <br><img src="./schema-import-screenshot1.png"/><br><br>

            <br>

            <li>
                Next a dialog box will appear where you can enter the fully qualified file name of the fortress schema.
            </li>
            <br><img src="./schema-import-screenshot2.png"/><br><br>

            <br>

            <li>
                The schema file is located under the fortress core base package/ldap/schema/apacheds-fortress.ldif
            </li>
            <br><img src="./schema-import-screenshot3.png"/><br><br>

            <br>

            <li>
                Verify success by viewing the cn=fortress schema node.
            </li>
            <br><img src="./schema-import-screenshot4.png"/><br><br>

        </ol>

    </li>

    <br>

    <li>
        Setup partition in ApacheDS server matching ldap server params in <b>config/fortress.properties</b> file.
    </li>

    <br>

    <li>
        Build the fortress LDAP DIT, create its config node and load the A/RBAC policies:
                <pre>
                    <p style="font: monospace; color: black; background-color: lightgrey; font-size: 10pt">
mvn install -Dload.file=./ldap/setup/refreshLDAPData.xml -DskipTests
mvn install -Dload.file=./ldap/setup/DelegatedAdminManagerLoad.xml -DskipTests

                    </p>
                </pre>
    </li>

    <li>
        Run the Fortress Core Regression Tess:
                <pre>
                    <p style="font: monospace; color: black; background-color: lightgrey; font-size: 10pt">
# mvn -Dtest=FortressJUnitTest test
                    </p>
                </pre>
        Tests should run with no errors.
    </li>
</ol>
</body>
<p style="font: monospace; color: black; font-size: 6pt">Copyright 2003-2015, The Apache Software Foundation. All Rights
    Reserved.</p>
</html>
